<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 邮件 | 武眉博]]></title>
  <link href="http://huobazi.github.com/blog/tag/邮件/atom.xml" rel="self"/>
  <link href="http://huobazi.github.com/"/>
  <updated>2012-11-27T20:53:15+08:00</updated>
  <id>http://huobazi.github.com/</id>
  <author>
    <name><![CDATA[Marble Wu]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Asp.Net发邮件，如何发送附件]]></title>
    <link href="http://huobazi.github.com/blog/2009/07/21/how-to-send-an-email-with-attachments/"/>
    <updated>2009-07-21T17:20:00+08:00</updated>
    <id>http://huobazi.github.com/blog/2009/07/21/how-to-send-an-email-with-attachments</id>
    <content type="html"><![CDATA[<p>使用如下代码可以发送附件</p>


<pre>MailMessage mail = new MailMessage();
mail.To = "me@mycompany.com";
mail.From = "you@yourcompany.com";
mail.Subject = "this is a test email.";
mail.Body = "this is my test email body.";
MailAttachment attachment = new MailAttachment( Server.MapPath( "mailTest.txt" ) ); //create the attachment
mail.Attachments.Add( attachment );
SmtpMail.SmtpServer = "localhost"; 
SmtpMail.Send( mail );</pre>


<p>使用如下代码可以在用户上传附件后发生邮件:</p>


<p><!--more--></p>


<pre>if  (FileUpload1.HasFile)
{
    string  toAddress  =  "you@yourprovider.com";
    string  fromAddress  =  you@yourprovider.com  (2);
    string  mailServer  =  "smtp.yourprovider.com";

    MailMessage  myMailMessage  =  new  MailMessage();

    myMailMessage.To.Add(toAddress);
    myMailMessage.From  =  new  MailAddress(fromAddress);
    myMailMessage.Subject  =  "Test  Message";

    string  fileName  =  Path.GetFileName(FileUpload1.PostedFile.FileName);
    Attachment  myAttachment  =  
                                  new  Attachment(FileUpload1.FileContent,  fileName);
    myMailMessage.Attachments.Add(myAttachment);

    SmtpClient  mySmtpClient  =  new  SmtpClient(mailServer);

    mySmtpClient.Send(myMailMessage);
}</pre>


<p></p>
]]></content>
  </entry>
  
</feed>
