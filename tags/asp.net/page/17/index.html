<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asp.Net &middot; 武眉博</title>

    <meta name="description" content="Marble&#39;s blog">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="huobazi" />
    <meta name="twitter:title" content="Asp.Net &middot; 武眉博">
    <meta name="twitter:description" content="Marble&#39;s blog">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Asp.Net &middot; 武眉博">
    <meta property="og:description" content="Marble&#39;s blog">

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <link href='http://fonts.useso.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
    
    
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">
    

    <link rel="stylesheet" href="/css/all.min.css">
    <link href="http://apps.bdimg.com/libs/fontawesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="http://huobazi.aspxboy.com/">武眉博</a></h1>
            <h2 class="brand-tagline"> Marble&#39;s blog </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="http://twitter.com/huobazi"><i class="fa fa-twitter"></i> Twitter</a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" href="http://github.com/huobazi "><i class="fa fa-github-alt"></i> github</a>
                </li>
                
            </ul>
        </nav>
    </div>
</div>

    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">14 Mar 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/03/14/cb-3113/" class="post-title">一个比较郁闷的问题</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-Asp.net" href="http://huobazi.aspxboy.com//tags/asp.net">Asp.net</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>我在我的主页 <a href="http://www.AspxBoy.com">http://www.AspxBoy.com</a> 内<br />文章显示页面是在添加文章的时候生成的静态htm页。<br />在首页和其他栏目显示文章列表时链接为<br /><a href="http://www.aspxboy.com/ShowArticle.Aspx?ID=214">http://www.aspxboy.com/ShowArticle.Aspx?ID=214</a><br />这样的链接<br />在ShowArticle.Aspx内为文章的被阅读次数加1，跳转到（<span style="color: #ff3333;"><strong>Response.Redirect</strong></span>）相应的Html文件<br />如<br /><a href="http://www.aspxboy.com/Files/71/66/20039280037.htm">http://www.aspxboy.com/Files/71/66/20039280037.htm</a><br />最近发现这样的设计导致搜索引擎抓取不到页面<img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg" alt=""><br />好友<a href="http://0day.com.cn">龙龙</a>放出他的<a href="http://home.0day.com.cn/search.php">龙族蜘蛛</a>在我的站内老是抓取不到任何可用链接<img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg" alt="">,只能抓到首页就进行不下去了......<br />不只该如何解决，郁闷啊。</p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">14 Mar 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/03/14/cb-3113/" class="post-title">一个比较郁闷的问题</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-Asp.net" href="http://huobazi.aspxboy.com//tags/asp.net">Asp.net</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>我在我的主页 <a href="http://www.AspxBoy.com">http://www.AspxBoy.com</a> 内<br />文章显示页面是在添加文章的时候生成的静态htm页。<br />在首页和其他栏目显示文章列表时链接为<br /><a href="http://www.aspxboy.com/ShowArticle.Aspx?ID=214">http://www.aspxboy.com/ShowArticle.Aspx?ID=214</a><br />这样的链接<br />在ShowArticle.Aspx内为文章的被阅读次数加1，跳转到（<span style="color: #ff3333;"><strong>Response.Redirect</strong></span>）相应的Html文件<br />如<br /><a href="http://www.aspxboy.com/Files/71/66/20039280037.htm">http://www.aspxboy.com/Files/71/66/20039280037.htm</a><br />最近发现这样的设计导致搜索引擎抓取不到页面<img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg" alt=""><br />好友<a href="http://0day.com.cn">龙龙</a>放出他的<a href="http://home.0day.com.cn/search.php">龙族蜘蛛</a>在我的站内老是抓取不到任何可用链接<img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg" alt="">,只能抓到首页就进行不下去了......<br />不只该如何解决，郁闷啊。</p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">14 Mar 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/03/14/cb-3122/" class="post-title">落伍者三周岁了</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-落伍者" href="http://huobazi.aspxboy.com//tags/%E8%90%BD%E4%BC%8D%E8%80%85">落伍者</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>我常泡的一个论坛&lt;&lt;<a href="http://www.im286.com">落伍者</a>&gt;&gt;三周岁了，<br />小贺一下<br />公布我的AspxBoy.Com.Article的源代码<br />帖子在<a href="http://www.im286.com/viewthread.php?tid=445594">这里</a><br />源码在<a href="http://www.aspxboy.com/code/">这里</a><br />希望各位指正。<br /></p>              

                    </div>
                </section>
                
                <h1 class="content-subhead">04 Mar 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/03/04/cb-2135/" class="post-title">MessageBox Control in ASP.NET</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-Asp.net" href="http://huobazi.aspxboy.com//tags/asp.net">Asp.net</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><p>在ASP.NET里实现MessageBox<br /><a href="http://www.microsoft.com/india/msdn/articles/119.aspx"><br /><a href="http://www.microsoft.com/india/msdn/articles/119.aspx">http://www.microsoft.com/india/msdn/articles/119.aspx</a></a>?<br /><img style="border: 0px;" src="/images/hbz_images/977dece2-f702-4e70-8c7c-13638de26e08.gif" border="0" alt=""></p>
<table style="BORDER-COLLAPSE: collapse" border="0" cellspacing="0" cellpadding="0" width="100%" bordercolor="#111111"><tbody>
<tr><td class="midlle" align="left"><strong>ShowMessageAtStartup</strong></td></tr>
<tr><td class="midlle" align="left"> </td></tr>
<tr><td class="midlle" align="left">This control is used to show message at startup of the page. For example, if you want to inform the user with some information using message box after the post back. Then you can use this control. This control has following two properties,</td></tr>
<tr><td class="midlle" align="left"> </td></tr>
<tr>
<td class="midlle">
<table border="0" cellspacing="2" cellpadding="2" width="100%">
<br /><tbody>
<br /><tr>
<br /><td class="midlle" width="15%" align="left" valign="top">
<strong>MessageText</strong>:</td>
<td class="midlle" width="85%" align="left">This property is used to set the Message which is showed in the message box.</td>
</tr>
<tr>
<td class="midlle" align="left" valign="top">
<strong>Enabled</strong>:</td>
<td class="midlle" align="left">This property is used for enabling or disabling this control depending upon the<br />requirement.</td>
</tr>
</tbody>
</table>
<p></p>
</td>
<br />
</tr>
<br /><tr><td class="midlle" align="left"> </td></tr>
<br /><tr><td class="midlle" align="left"><strong>MessageAtSubmit</strong></td></tr>
<br /><tr><td class="midlle" align="left"> </td></tr>
<br /><tr><td class="midlle" align="left">This control is used to show alert message or confirm message box when the page is submitted. For example, when the user is pressing a button to delete a record. During that time, if you want to ask the user for confirmation. Then you can use this control. This control has following properties,</td></tr>
<br /><tr><td class="midlle" align="left"> </td></tr>
<br /><tr>
<td class="midlle">
<table border="0" cellspacing="2" cellpadding="2" width="100%">
<br /><tbody>
<br /><tr>
<br /><td class="midlle" width="30%" align="left" valign="top">
<strong>MessageText</strong>:</td>
<td class="midlle" width="70%" align="left">This property is used to set the Message which is showed in the message box.</td>
</tr>
<br /><tr>
<td class="midlle" align="left" valign="top">
<strong>Enabled</strong>:</td>
<td class="midlle" align="left">This property is used for enabling or disabling this control depending upon the<br />requirement.</td>
</tr>
<br /><tr>
<td class="midlle" align="left" valign="top">
<strong>IsConfirmMessage</strong>:</td>
<td class="midlle" align="left">This property is used to mention whether it is confirmation message box or alert message box.</td>
</tr>
<br /><tr>
<td class="midlle" align="left" valign="top">
<strong>ConfirmMessagePassClientScript</strong>:</td>
<td class="midlle" align="left">This property is used to mention the client side script which has to executed if the confirmation message return true. i.e. when users presses ok button. This property will be used only when isConfirmmessage property is set to true</td>
</tr>
<br /><tr>
<td class="midlle" align="left" valign="top">
<strong>ConfirmMessageFailClientScript</strong>:</td>
<td class="midlle" align="left">This property is used to mention the client side script which<br />has to executed if the confirmation message return false. i.e. when users presses<br />cancel button. This property will be used only when isConfirmmessage property<br />is set to true.</td>
</tr>
<br />
</tbody>
</table>
<p></p>
</td>
<br />
</tr>
<br />
</tbody></table></p>

                    </div>
                </section>
                
                <h1 class="content-subhead">04 Mar 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/03/04/cb-2135/" class="post-title">MessageBox Control in ASP.NET</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-Asp.net" href="http://huobazi.aspxboy.com//tags/asp.net">Asp.net</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><p>在ASP.NET里实现MessageBox<br /><a href="http://www.microsoft.com/india/msdn/articles/119.aspx"><br /><a href="http://www.microsoft.com/india/msdn/articles/119.aspx">http://www.microsoft.com/india/msdn/articles/119.aspx</a></a>?<br /><img style="border: 0px;" src="/images/hbz_images/977dece2-f702-4e70-8c7c-13638de26e08.gif" border="0" alt=""></p>
<table style="BORDER-COLLAPSE: collapse" border="0" cellspacing="0" cellpadding="0" width="100%" bordercolor="#111111"><tbody>
<tr><td class="midlle" align="left"><strong>ShowMessageAtStartup</strong></td></tr>
<tr><td class="midlle" align="left"> </td></tr>
<tr><td class="midlle" align="left">This control is used to show message at startup of the page. For example, if you want to inform the user with some information using message box after the post back. Then you can use this control. This control has following two properties,</td></tr>
<tr><td class="midlle" align="left"> </td></tr>
<tr>
<td class="midlle">
<table border="0" cellspacing="2" cellpadding="2" width="100%">
<br /><tbody>
<br /><tr>
<br /><td class="midlle" width="15%" align="left" valign="top">
<strong>MessageText</strong>:</td>
<td class="midlle" width="85%" align="left">This property is used to set the Message which is showed in the message box.</td>
</tr>
<tr>
<td class="midlle" align="left" valign="top">
<strong>Enabled</strong>:</td>
<td class="midlle" align="left">This property is used for enabling or disabling this control depending upon the<br />requirement.</td>
</tr>
</tbody>
</table>
<p></p>
</td>
<br />
</tr>
<br /><tr><td class="midlle" align="left"> </td></tr>
<br /><tr><td class="midlle" align="left"><strong>MessageAtSubmit</strong></td></tr>
<br /><tr><td class="midlle" align="left"> </td></tr>
<br /><tr><td class="midlle" align="left">This control is used to show alert message or confirm message box when the page is submitted. For example, when the user is pressing a button to delete a record. During that time, if you want to ask the user for confirmation. Then you can use this control. This control has following properties,</td></tr>
<br /><tr><td class="midlle" align="left"> </td></tr>
<br /><tr>
<td class="midlle">
<table border="0" cellspacing="2" cellpadding="2" width="100%">
<br /><tbody>
<br /><tr>
<br /><td class="midlle" width="30%" align="left" valign="top">
<strong>MessageText</strong>:</td>
<td class="midlle" width="70%" align="left">This property is used to set the Message which is showed in the message box.</td>
</tr>
<br /><tr>
<td class="midlle" align="left" valign="top">
<strong>Enabled</strong>:</td>
<td class="midlle" align="left">This property is used for enabling or disabling this control depending upon the<br />requirement.</td>
</tr>
<br /><tr>
<td class="midlle" align="left" valign="top">
<strong>IsConfirmMessage</strong>:</td>
<td class="midlle" align="left">This property is used to mention whether it is confirmation message box or alert message box.</td>
</tr>
<br /><tr>
<td class="midlle" align="left" valign="top">
<strong>ConfirmMessagePassClientScript</strong>:</td>
<td class="midlle" align="left">This property is used to mention the client side script which has to executed if the confirmation message return true. i.e. when users presses ok button. This property will be used only when isConfirmmessage property is set to true</td>
</tr>
<br /><tr>
<td class="midlle" align="left" valign="top">
<strong>ConfirmMessageFailClientScript</strong>:</td>
<td class="midlle" align="left">This property is used to mention the client side script which<br />has to executed if the confirmation message return false. i.e. when users presses<br />cancel button. This property will be used only when isConfirmmessage property<br />is set to true.</td>
</tr>
<br />
</tbody>
</table>
<p></p>
</td>
<br />
</tr>
<br />
</tbody></table></p>

                    </div>
                </section>
                
                <h1 class="content-subhead">23 Feb 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/02/23/cb-1521/" class="post-title">用Asp.Net抓取web页面</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-Asp.net" href="http://huobazi.aspxboy.com//tags/asp.net">Asp.net</a><a class="post-category post-category-代码片段" href="http://huobazi.aspxboy.com//tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5">代码片段</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><span style="color: #990000;">演示:<br /><a href="http://www.aspxboy.com/demo/286.aspx" target="_blank">http://www.aspxboy.com/demo/286.aspx</a></span></p>
<p><span style="color: #990000;"><br />代码高亮显示(HightLight in <a href="http://www.aspxboy.com/scv/">Source Code Viewer</a>)</span></p>
<p><span style="color: #990000;"><br /><a href="http://www.aspxboy.com/code/default.aspx/S7s2zPJbeI9PJA/OKHpAVwVaUEhf02EgEOgeB3Yd5Z7fLL3ZNgdv7XIqertUOYm9kbQ62LshbJBwvWPBBYa4EyVMhvMhyEDPH8chU5ornn8=.Aspx" target="_blank">http://www.aspxboy.com/code/default.aspx/S7s2zPJbeI9PJA/OK<br />HpAVwVaUEhf02EgEOgeB3Yd5Z7fLL3ZNgdv7XIqertUOYm9kbQ62<br />LshbJBwvWPBBYa4EyVMhvMhyEDPH8chU5ornn8=.Aspx</a></span><br /><span style="color: #990000;">&lt;html&gt;<br />&lt;head&gt;<br /> </span><br /><span style="color: #990000;">&lt;SCRIPT runat="server"&gt;<br />  void Page_Load(Object sender, EventArgs e) {</span><br /><span style="color: #990000;">    WebRequest req = WebRequest.Create("<a href="http://www.im286.com/index.php" target="_blank">http://www.im286.com/index.php</a>");<br /> string urliii="src="; //图片使用绝对连接<br /> urliii+="<a href="http://www.im286.com/" target="_blank">http://www.im286.com/</a>";<br />    try {<br />        WebResponse result = req.GetResponse();<br />        Stream ReceiveStream = result.GetResponseStream();</span><br /><span style="color: #990000;">        Byte[] read = new Byte[512];<br />        int bytes = ReceiveStream.Read(read, 0, 512);</span><br /><span style="color: #990000;">        lblHTML.Text = "";<br />        while (bytes &gt; 0)<br />        {</span><br /><span style="color: #990000;">          // 注意：<br />          // 下面假定响应使用 gb2312 作为编码方式。<br />          // 如果内容以 ANSI 代码页形式（例如，932）发送，则使用类似下面的语句：<br />          //Encoding encode = System.Text.Encoding.GetEncoding("shift-jis");<br />          Encoding encode = System.Text.Encoding.GetEncoding("gb2312");<br />          lblHTML.Text = lblHTML.Text + encode.GetString(read, 0, bytes);<br />   <br />          bytes = ReceiveStream.Read(read, 0, 512);<br />   <br />        }<br />    } catch(Exception) {<br />        lblHTML.Text = "检索页时出错";<br />    }<br /> lblHTML.Text = lblHTML.Text.Replace("src=",""+urliii+"");<br /> lblHTML.Text = lblHTML.Text.Replace("\"","");<br />  }<br />&lt;/SCRIPT&gt;<br />&lt;/head&gt;</span><br /><span style="color: #990000;">&lt;body&gt;</span><br /><span style="color: #990000;">  &lt;form method="post" action="Webrequest.aspx" runat="server"&gt;<br />   <br />    &lt;asp:Label runat=server ID="lblHTML" Rows="30" Cols="80" EnableViewState="false"  Wrap="True"&gt;&lt;/asp:Label&gt;<br />  &lt;/form&gt;</span><br /><span style="color: #990000;">&lt;/body&gt;<br />&lt;/html&gt;</span></p>
<p>&lt;%@ Page language="C#" Trace="True" %&gt;<br />&lt;%@ Import Namespace="System.Net" %&gt;<br />&lt;%@ Import Namespace="System.IO" %&gt;</p>              

                    </div>
                </section>
                
                <h1 class="content-subhead">23 Feb 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/02/23/cb-1521/" class="post-title">用Asp.Net抓取web页面</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-Asp.net" href="http://huobazi.aspxboy.com//tags/asp.net">Asp.net</a><a class="post-category post-category-代码片段" href="http://huobazi.aspxboy.com//tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5">代码片段</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><span style="color: #990000;">演示:<br /><a href="http://www.aspxboy.com/demo/286.aspx" target="_blank">http://www.aspxboy.com/demo/286.aspx</a></span></p>
<p><span style="color: #990000;"><br />代码高亮显示(HightLight in <a href="http://www.aspxboy.com/scv/">Source Code Viewer</a>)</span></p>
<p><span style="color: #990000;"><br /><a href="http://www.aspxboy.com/code/default.aspx/S7s2zPJbeI9PJA/OKHpAVwVaUEhf02EgEOgeB3Yd5Z7fLL3ZNgdv7XIqertUOYm9kbQ62LshbJBwvWPBBYa4EyVMhvMhyEDPH8chU5ornn8=.Aspx" target="_blank">http://www.aspxboy.com/code/default.aspx/S7s2zPJbeI9PJA/OK<br />HpAVwVaUEhf02EgEOgeB3Yd5Z7fLL3ZNgdv7XIqertUOYm9kbQ62<br />LshbJBwvWPBBYa4EyVMhvMhyEDPH8chU5ornn8=.Aspx</a></span><br /><span style="color: #990000;">&lt;html&gt;<br />&lt;head&gt;<br /> </span><br /><span style="color: #990000;">&lt;SCRIPT runat="server"&gt;<br />  void Page_Load(Object sender, EventArgs e) {</span><br /><span style="color: #990000;">    WebRequest req = WebRequest.Create("<a href="http://www.im286.com/index.php" target="_blank">http://www.im286.com/index.php</a>");<br /> string urliii="src="; //图片使用绝对连接<br /> urliii+="<a href="http://www.im286.com/" target="_blank">http://www.im286.com/</a>";<br />    try {<br />        WebResponse result = req.GetResponse();<br />        Stream ReceiveStream = result.GetResponseStream();</span><br /><span style="color: #990000;">        Byte[] read = new Byte[512];<br />        int bytes = ReceiveStream.Read(read, 0, 512);</span><br /><span style="color: #990000;">        lblHTML.Text = "";<br />        while (bytes &gt; 0)<br />        {</span><br /><span style="color: #990000;">          // 注意：<br />          // 下面假定响应使用 gb2312 作为编码方式。<br />          // 如果内容以 ANSI 代码页形式（例如，932）发送，则使用类似下面的语句：<br />          //Encoding encode = System.Text.Encoding.GetEncoding("shift-jis");<br />          Encoding encode = System.Text.Encoding.GetEncoding("gb2312");<br />          lblHTML.Text = lblHTML.Text + encode.GetString(read, 0, bytes);<br />   <br />          bytes = ReceiveStream.Read(read, 0, 512);<br />   <br />        }<br />    } catch(Exception) {<br />        lblHTML.Text = "检索页时出错";<br />    }<br /> lblHTML.Text = lblHTML.Text.Replace("src=",""+urliii+"");<br /> lblHTML.Text = lblHTML.Text.Replace("\"","");<br />  }<br />&lt;/SCRIPT&gt;<br />&lt;/head&gt;</span><br /><span style="color: #990000;">&lt;body&gt;</span><br /><span style="color: #990000;">  &lt;form method="post" action="Webrequest.aspx" runat="server"&gt;<br />   <br />    &lt;asp:Label runat=server ID="lblHTML" Rows="30" Cols="80" EnableViewState="false"  Wrap="True"&gt;&lt;/asp:Label&gt;<br />  &lt;/form&gt;</span><br /><span style="color: #990000;">&lt;/body&gt;<br />&lt;/html&gt;</span></p>
<p>&lt;%@ Page language="C#" Trace="True" %&gt;<br />&lt;%@ Import Namespace="System.Net" %&gt;<br />&lt;%@ Import Namespace="System.IO" %&gt;</p>              

                    </div>
                </section>
                
                <h1 class="content-subhead">12 Feb 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/02/12/cb-1192/" class="post-title">一个不错的代码编辑工具</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>CrimSon Editer<br /><a href="http://www.crimsoneditor.com/" target="_blank"><br />http://www.crimsoneditor.com/</a><br />我用它因为它体积小 启动迅速 最大的优点是<span style="font-size: large; color: #ff3300;"><strong>免费</strong></span>哦<br />支持许多常用代码的语法高亮显示.<br />可以在这里下载到C#的代码高亮显示文件<br /><a target="_blank">http://www.crimsoneditor.com/board/CrazyWWWBoard.cgi?db=user0&amp;mode=read&amp;num=99&amp;page=1&amp;ftype=6&amp;fval=c%23&amp;backdepth=1</a></p>
<p>还有其他好的编辑工具都列在这里了:<br /><a href="http://www.crimsoneditor.com/english/editors.html" target="_blank">http://www.crimsoneditor.com/english/editors.html</a></p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">09 Feb 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/02/09/pagedsp/" class="post-title">分页存储过程</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-LAMP" href="http://huobazi.aspxboy.com//tags/lamp">LAMP</a><a class="post-category post-category-Asp.net" href="http://huobazi.aspxboy.com//tags/asp.net">Asp.net</a><a class="post-category post-category-SQL Server" href="http://huobazi.aspxboy.com//tags/sql-server">SQL Server</a><a class="post-category post-category-分页" href="http://huobazi.aspxboy.com//tags/%E5%88%86%E9%A1%B5">分页</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>搞了一中午终于可以用了 但不知道效率如何.郁闷的是我要用php去调用它</p>
<p><span style="color: #008000;">  /*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br />    CopyRight：   ******<br />    CreateData：   2004-02-09<br />    Language：   MS SQL SERVER 存储过程<br />    AuthorName：  Meibo Wu</span><br /><span style="color: #008000;">    实现功能：   分页显示当用户选择了图片大分类时(按手机)的数据<br />    参数说明：   @bigtype为大分类<br />    @gid为传入的图片类型           <br />        $PageSize为每页显示的记录数量<br />    @pageindex为当前页码                             <br />    LastUpdate:            <br />    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/<br />CREATE procedure sms_img_page_no_smalltype<br />(<br /> @bigtype nvarchar(20),<br /> @gid int,<br /> @pagesize int,<br /> @pageindex int<br />)<br />as<br />set nocount on<br /> declare @LikeBigType nvarchar(20)<br /> declare @PageLowerBound int<br /> declare @PageUpperBound int<br /> declare @indextable table(id int identity(1,1),nid int)<br />  set @PageLowerBound=(@pageindex-1)*@pagesize<br />  set @PageUpperBound= @PageLowerBound+@pagesize<br />  set @LikeBigType= @bigtype+'%'<br />  set rowcount @PageUpperBound<br /> insert into @indextable(nid)<br />  select  a.col_id<br />   from web_sms_data_img as a join web_sms_data_mobile as q<br />   on a.col_mobile_type=q.col_mobile_type<br />   where </span><a href="mailto:a.col_img_group=@gid"><span style="color: #008000;">a.col_img_group=@gid</span></a><span style="color: #008000;"><br />    and q.col_mobile_comment  like @LikeBigType<br />   order by a.col_id desc <br /> /*<br /> select  @LikeBigType<br /> select * from @indextable <br /> */<br /> select q.col_mobile_comment,<br />  a.col_id,<br />  a.col_img_hits,<br />  a.col_img_dir,<br />  a.col_img_name<br />  from web_sms_data_img as a join web_sms_data_mobile as q<br />   on a.col_mobile_type=q.col_mobile_type<br />    join @indextable  as p<br />    on a.col_id=p.nid<br />  where p.id&gt;@PageLowerBound and p.id&lt;</span><a href="mailto:=@PageUpperBound"><span style="color: #008000;">=@PageUpperBound</span></a><span style="color: #008000;"><br />   and </span><a href="mailto:a.col_img_group=@gid"><span style="color: #008000;">a.col_img_group=@gid</span></a><span style="color: #008000;"><br />   and q.col_mobile_comment like @LikeBigType<br /> <br /> order by p.id</span></p>
<p><span style="color: #008000;">set nocount off<br />GO<br /></span></p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">09 Feb 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://huobazi.aspxboy.com/blog/2004/02/09/pagedsp/" class="post-title">分页存储过程</a>

                        <p class="post-meta">
                            
                            
                                
                                <a class="post-category post-category-ASP.NET" href="http://huobazi.aspxboy.com//tags/asp.net">ASP.NET</a><a class="post-category post-category-LAMP" href="http://huobazi.aspxboy.com//tags/lamp">LAMP</a><a class="post-category post-category-Asp.net" href="http://huobazi.aspxboy.com//tags/asp.net">Asp.net</a><a class="post-category post-category-SQL Server" href="http://huobazi.aspxboy.com//tags/sql-server">SQL Server</a><a class="post-category post-category-分页" href="http://huobazi.aspxboy.com//tags/%E5%88%86%E9%A1%B5">分页</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>搞了一中午终于可以用了 但不知道效率如何.郁闷的是我要用php去调用它</p>
<p><span style="color: #008000;">  /*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br />    CopyRight：   ******<br />    CreateData：   2004-02-09<br />    Language：   MS SQL SERVER 存储过程<br />    AuthorName：  Meibo Wu</span><br /><span style="color: #008000;">    实现功能：   分页显示当用户选择了图片大分类时(按手机)的数据<br />    参数说明：   @bigtype为大分类<br />    @gid为传入的图片类型           <br />        $PageSize为每页显示的记录数量<br />    @pageindex为当前页码                             <br />    LastUpdate:            <br />    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/<br />CREATE procedure sms_img_page_no_smalltype<br />(<br /> @bigtype nvarchar(20),<br /> @gid int,<br /> @pagesize int,<br /> @pageindex int<br />)<br />as<br />set nocount on<br /> declare @LikeBigType nvarchar(20)<br /> declare @PageLowerBound int<br /> declare @PageUpperBound int<br /> declare @indextable table(id int identity(1,1),nid int)<br />  set @PageLowerBound=(@pageindex-1)*@pagesize<br />  set @PageUpperBound= @PageLowerBound+@pagesize<br />  set @LikeBigType= @bigtype+'%'<br />  set rowcount @PageUpperBound<br /> insert into @indextable(nid)<br />  select  a.col_id<br />   from web_sms_data_img as a join web_sms_data_mobile as q<br />   on a.col_mobile_type=q.col_mobile_type<br />   where </span><a href="mailto:a.col_img_group=@gid"><span style="color: #008000;">a.col_img_group=@gid</span></a><span style="color: #008000;"><br />    and q.col_mobile_comment  like @LikeBigType<br />   order by a.col_id desc <br /> /*<br /> select  @LikeBigType<br /> select * from @indextable <br /> */<br /> select q.col_mobile_comment,<br />  a.col_id,<br />  a.col_img_hits,<br />  a.col_img_dir,<br />  a.col_img_name<br />  from web_sms_data_img as a join web_sms_data_mobile as q<br />   on a.col_mobile_type=q.col_mobile_type<br />    join @indextable  as p<br />    on a.col_id=p.nid<br />  where p.id&gt;@PageLowerBound and p.id&lt;</span><a href="mailto:=@PageUpperBound"><span style="color: #008000;">=@PageUpperBound</span></a><span style="color: #008000;"><br />   and </span><a href="mailto:a.col_img_group=@gid"><span style="color: #008000;">a.col_img_group=@gid</span></a><span style="color: #008000;"><br />   and q.col_mobile_comment like @LikeBigType<br /> <br /> order by p.id</span></p>
<p><span style="color: #008000;">set nocount off<br />GO<br /></span></p>               

                    </div>
                </section>
                
            </div>
            
<div class="pagination">
  <nav role="pagination" class="post-list-pagination">
      
      <a href="/tags/asp/index.net/page/16/" class="post-list-pagination-item pure-button post-list-pagination-item-prev">
        <i class="fa fa-angle-double-left"></i>&nbsp;Newer
      </a>
      
    <span class="post-list-pagination-item post-list-pagination-item-current">Page 17 of 18</span>
    
      <a href="/tags/asp/index.net/page/18/" class="post-list-pagination-item pure-button post-list-pagination-item-next">
        Older&nbsp;<i class="fa fa-angle-double-right"></i>
      </a>
    
  </nav>
</div>


            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="http://hugo.spf13.com/" target="_blank">hugo</a> &nbsp;&nbsp; theme by <a target="_blank" href="https://github.com/dplesca/purehugo">purehugo</a></a></li>
        </ul>
    </div>
</div>
<script src="/js/all.min.js"></script>

        </div>
    </div>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-56321-3', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
