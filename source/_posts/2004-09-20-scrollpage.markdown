---
layout: post
title: Scroll Page 表单提交后页面重新滚回原来滚动条所在位置
comments: true
date: 2004-09-20 13:55
categories:
- ASP.NET
- 前端开发
- Asp.net
---

<p>作者<span style="text-decoration: underline;"><span style="color: #800080;"><a href="http://scottwater.com/">scottwater</a><br /></span></span>原文地址：<a href="http://scottwater.com/articles/ScrollPage">http://scottwater.com/articles/ScrollPage</a><br />感谢<a href="http://scottwater.com/">scottwater</a>先生！<br />我做了一点修改，使其支持横向滚动条位置的记忆</p>
<div style="padding-right: 5.4pt; padding-left: 5.4pt; background: #e6e6e6; padding-bottom: 4px; width: 98%; padding-top: 4px; border: windowtext 0.5pt solid;">
<div>
<span id="Codehighlighter1_0_387_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">Disclaimer</span><span id="Codehighlighter1_0_387_Open_Text" style="DISPLAY: none"><span style="COLOR: #0000ff">#region</span><span style="COLOR: #000000"> Disclaimer</span><span style="COLOR: #000000"><br /></span><span id="Codehighlighter1_19_376_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="Codehighlighter1_19_376_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">*********************************************************************<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top">Based on presentation by Brad McCabe of Infragistics<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top">Updated by Scott Watermasysk (</span><span style="FONT-WEIGHT: bold; COLOR: #008000">http://scottwater.com</span><span style="COLOR: #008000">)<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top">Provided as is, with no warrenty, etc.<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top">Please use however you see fit. Just don't ask for a VB version :)<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top">**********************************************************************</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">#endregion</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">using</span><span style="COLOR: #000000"> System;<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">using</span><span style="COLOR: #000000"> System.IO;<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">using</span><span style="COLOR: #000000"> System.Text;<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">using</span><span style="COLOR: #000000"> System.Text.RegularExpressions;<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">using</span><span style="COLOR: #000000"> System.Web.UI;<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">namespace</span><span style="COLOR: #000000"> ShangGu.XaTaxi.Components<br /></span><span id="Codehighlighter1_536_3833_Open_Text"><span style="COLOR: #000000">{<br /> </span><span id="Codehighlighter1_539_609_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="Codehighlighter1_539_609_Open_Text"><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> </span><span style="COLOR: #808080">&lt;summary&gt;</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> Summary description for ScrollPage.<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> </span><span style="COLOR: #808080">&lt;/summary&gt;</span></span><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">public</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">class</span><span style="COLOR: #000000"> ScrollPage : System.Web.UI.Page<br /> </span><span id="Codehighlighter1_657_3830_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">public</span><span style="COLOR: #000000"> ScrollPage()<br /> </span><span id="Codehighlighter1_683_688_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">private</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">bool</span><span style="COLOR: #000000"> _useScrollPersistence </span><span style="COLOR: #000000">=</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">true</span><span style="COLOR: #000000">;<br /> </span><span id="Codehighlighter1_738_959_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="Codehighlighter1_738_959_Open_Text"><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> </span><span style="COLOR: #808080">&lt;summary&gt;</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> There could be PostBack senarios where we do not want to remember the scroll position. Set this property to false<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> if you would like the page to forget the current scroll position<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> </span><span style="COLOR: #808080">&lt;/summary&gt;</span></span><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">public</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">bool</span><span style="COLOR: #000000"> UseScrollPersistence<br /> </span><span id="Codehighlighter1_997_1090_Open_Text"><span style="COLOR: #000000">{<br /> </span><span style="COLOR: #0000ff">get</span><span style="COLOR: #000000"> </span><span id="Codehighlighter1_1006_1041_Open_Text"><span style="COLOR: #000000">{</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">this</span><span style="COLOR: #000000">._useScrollPersistence;}</span></span><span style="COLOR: #000000"><br /></span><span style="COLOR: #0000ff">set</span><span style="COLOR: #000000"> </span><span id="Codehighlighter1_1050_1086_Open_Text"><span style="COLOR: #000000">{</span><span style="COLOR: #0000ff">this</span><span style="COLOR: #000000">._useScrollPersistence </span><span style="COLOR: #000000">=</span><span style="COLOR: #000000"> value;}</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">private</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000"> _bodyID;<br /></span><span id="Codehighlighter1_1121_1372_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="Codehighlighter1_1121_1372_Open_Text"><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> </span><span style="COLOR: #808080">&lt;summary&gt;</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> Some pages might already have the ID attribute set for the body tag. Setting this property will not render the ID or change<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> the existing value. It will simply update the javascript written out to the browser.<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #808080">///</span><span style="COLOR: #008000"> </span><span style="COLOR: #808080">&lt;/summary&gt;</span></span><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">public</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000"> BodyID<br /> </span><span id="Codehighlighter1_1398_1463_Open_Text"><span style="COLOR: #000000">{<br /> </span><span style="COLOR: #0000ff">get</span><span style="COLOR: #000000"> </span><span id="Codehighlighter1_1407_1428_Open_Text"><span style="COLOR: #000000">{</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">this</span><span style="COLOR: #000000">._bodyID;}</span></span><span style="COLOR: #000000"><br /> </span><span style="COLOR: #0000ff">set</span><span style="COLOR: #000000"> </span><span id="Codehighlighter1_1437_1459_Open_Text"><span style="COLOR: #000000">{</span><span style="COLOR: #0000ff">this</span><span style="COLOR: #000000">._bodyID </span><span style="COLOR: #000000">=</span><span style="COLOR: #000000"> value;}</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">Last chance. Do we want to maintain the current scroll position</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">protected</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">override</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">void</span><span style="COLOR: #000000"> OnPreRender(EventArgs e)<br /> </span><span id="Codehighlighter1_1588_1683_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">(UseScrollPersistence)<br /> </span><span id="Codehighlighter1_1621_1654_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> RetainScrollPosition();<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">base</span><span style="COLOR: #000000">.OnPreRender (e);<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">protected</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">override</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">void</span><span style="COLOR: #000000"> Render(HtmlTextWriter writer)<br /> </span><span id="Codehighlighter1_1746_2589_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">No need processing the HTML if the user does not want to maintain scroll position or already has<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">set the body ID value</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">(UseScrollPersistence)<br /> </span><span id="Codehighlighter1_1908_2542_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> TextWriter tempWriter </span><span style="COLOR: #000000">=</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">new</span><span style="COLOR: #000000"> StringWriter();<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">base</span><span style="COLOR: #000000">.Render(</span><span style="COLOR: #0000ff">new</span><span style="COLOR: #000000"> HtmlTextWriter(tempWriter));<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">(BodyID </span><span style="COLOR: #000000">==</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">null</span><span style="COLOR: #000000">)<br /> </span><span id="Codehighlighter1_2034_2153_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> writer.Write(Regex.Replace(tempWriter.ToString(),</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">&lt;body</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">,</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">&lt;body id="thebody" </span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">,RegexOptions.IgnoreCase));<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">=++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">2004－9－16 武眉博 修正了因BodyID不空时造成javascript错误的bug<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">=++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">else</span><span style="COLOR: #000000"><br /> </span><span id="Codehighlighter1_2414_2537_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> writer.Write(Regex.Replace(tempWriter.ToString(),</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">&lt;body</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">,</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">&lt;body id="</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">BodyID</span><span style="COLOR: #000000">+</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">" </span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">,RegexOptions.IgnoreCase));<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">else</span><span style="COLOR: #000000"><br /> </span><span id="Codehighlighter1_2555_2585_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">base</span><span style="COLOR: #000000">.Render(writer);<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">=++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">2004－9－20 武眉博 增加了隐藏文本域"__SCROLLPOS_LEFT"，以增加对横向滚动条位置的记忆功能<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">=++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">private</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">static</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000"> saveScrollPosition </span><span style="COLOR: #000000">=</span><span style="COLOR: #000000"> </span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">&lt;script language='javascript'&gt;function saveScrollPosition() {{document.forms[0].__SCROLLPOS_TOP.value = {0}.scrollTop;document.forms[0].__SCROLLPOS_LEFT.value = {0}.scrollLeft ;}}{0}.onscroll=saveScrollPosition;&lt;/script&gt;</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">;<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">private</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">static</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000"> setScrollPosition </span><span style="COLOR: #000000">=</span><span style="COLOR: #000000"> </span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">&lt;script language='javascript'&gt;function setScrollPosition() {{{0}.scrollTop ="{1}"; {0}.scrollLeft ="{2}"}}{0}.onload=setScrollPosition;&lt;/script&gt;</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">;<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">Write out javascript and hidden field</span><span style="COLOR: #008000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">private</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">void</span><span style="COLOR: #000000"> RetainScrollPosition()<br /> </span><span id="Codehighlighter1_3401_3827_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> RegisterHiddenField(</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">__SCROLLPOS_TOP</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">, </span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">);<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> RegisterHiddenField(</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">__SCROLLPOS_LEFT</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">, </span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">);<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000"> __bodyID </span><span style="COLOR: #000000">=</span><span style="COLOR: #000000"> BodyID </span><span style="COLOR: #000000">==</span><span style="COLOR: #000000"> </span><span style="COLOR: #0000ff">null</span><span style="COLOR: #000000"> </span><span style="COLOR: #000000">?</span><span style="COLOR: #000000"> </span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">thebody</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000"> : BodyID;<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> RegisterStartupScript(</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">saveScroll</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">, </span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000">.Format(saveScrollPosition,__bodyID));<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">(Page.IsPostBack)<br /> </span><span id="Codehighlighter1_3669_3823_Open_Text"><span style="COLOR: #000000">{<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> RegisterStartupScript(</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">setScroll</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">, </span><span style="COLOR: #0000ff">string</span><span style="COLOR: #000000">.Format(setScrollPosition,__bodyID, Request.Form[</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">__SCROLLPOS_TOP</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">],Request.Form[</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">__SCROLLPOS_LEFT</span><span style="COLOR: #000000">"</span><span style="COLOR: #000000">]));<br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"> }</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top">}</span></span><span style="COLOR: #000000"><br /><img src="/images/hbz_images/a58148e9-463d-4260-923c-252b1577586b.gif" alt="" align="top"></span>
</div>
<p></p>
</div>				
